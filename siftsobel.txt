import cv2 as cv
import numpy as np
from matplotlib import pyplot as plt
img = cv.imread(r"C:\Users\anu\OneDrive\Pictures\flowr.webp")
gray = cv.cvtColor(img, cv.COLOR_BGR2GRAY)
sobelx = cv.Sobel(gray, cv.CV_64F, 1, 0, ksize=3) 
sobely = cv.Sobel(gray, cv.CV_64F, 0, 1, ksize=3)
sobel = cv.magnitude(sobelx, sobely) 
sobel = np.uint8(np.absolute(sobel)) 
sift = cv.SIFT_create()
kp = sift.detect(sobel, None)
output = cv.drawKeypoints(sobel, kp, None, 
flags=cv.DRAW_MATCHES_FLAGS_DRAW_RICH_KEYPOINTS)
plt.subplot(121), plt.imshow(sobel, cmap='gray'), plt.title("Sobel Filtered Image")
plt.subplot(122), plt.imshow(output), plt.title("SIFT on Sobel Image")
plt.show()
